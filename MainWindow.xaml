<Window x:Class="GbxSolidTool.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:h="clr-namespace:HelixToolkit.Wpf;assembly=HelixToolkit.Wpf"
        Title="GbxSolidTool" Height="760" Width="1250">

    <Grid Margin="12">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="220"/>
        </Grid.RowDefinitions>

        <!-- Top bar -->
        <Border BorderBrush="#444" BorderThickness="1" CornerRadius="8" Padding="10" Margin="0,0,0,10">
            <DockPanel LastChildFill="True">
                <StackPanel DockPanel.Dock="Left">
                    <TextBlock FontSize="18" FontWeight="SemiBold" Text="GbxSolidTool"/>
                    <TextBlock Opacity="0.85" Margin="0,4,0,0"
                               Text="Ouvre un .3ds (bouton) ou glisse-dépose sur la zone 3D. Puis convertis vers XML."/>
                </StackPanel>

                <StackPanel DockPanel.Dock="Right" Orientation="Horizontal" VerticalAlignment="Center">
                    <Button Width="140" Height="34" Margin="0,0,8,0"
                            Click="BtnOpen3ds_Click" Content="Open .3ds"/>
                    <Button x:Name="BtnConvert" Width="140" Height="34" Margin="0,0,8,0"
                            Click="BtnConvert_Click" IsEnabled="False"
                            Content="Convert → XML"/>
					<Button x:Name="BtnPrepareTemplate"
                            Content="Prepare Template"
                            Width="140"
                            Height="34"
                            Margin="0,0,8,0"
                            Click="BtnPrepareTemplate_Click"
                            IsEnabled="False"/>
					<Button x:Name="BtnBuild"
                                Width="140"
                                Click="BtnBuild_Click"
                                   Content="Compile Solid"
                             IsEnabled="False"/>
					<Button x:Name="BtnOpenXml" Width="140" Height="34"
                            Click="BtnOpenXml_Click" IsEnabled="False"
                            Content="Open XML folder"/>
                </StackPanel>
            </DockPanel>
        </Border>

        <!-- Middle: 3D preview + file info -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="360"/>
            </Grid.ColumnDefinitions>

            <!-- 3D preview area (drag & drop here) -->
            <Border Grid.Column="0"
                    BorderBrush="#444" BorderThickness="1" CornerRadius="8"
                    Background="#111"
                    AllowDrop="True"
                    DragOver="Preview_DragOver"
                    Drop="Preview_Drop"
                    Margin="0,0,10,0">

                <Grid>
                    <h:HelixViewport3D x:Name="View3D" ShowFrameRate="False">
                        <h:SunLight/>
                        <!-- Model is injected in code-behind -->
                    </h:HelixViewport3D>

                    <!-- Overlay hint when no file -->
                    <Border x:Name="OverlayHint" Background="#66000000" CornerRadius="8"
                            Padding="16" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <StackPanel>
                            <TextBlock Foreground="White" FontSize="18" FontWeight="SemiBold"
                                       Text="Drop .3ds here"/>
                            <TextBlock Foreground="White" Opacity="0.85" Margin="0,6,0,0"
                                       Text="or click “Open .3ds”"/>
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <!-- Side panel -->
            <Border Grid.Column="1" BorderBrush="#444" BorderThickness="1" CornerRadius="8" Padding="10">
                <StackPanel>
                    <TextBlock FontWeight="SemiBold" Text="Current file"/>
                    <TextBlock x:Name="TxtFile" Opacity="0.85" Text="(none)" Margin="0,4,0,10" TextWrapping="Wrap"/>

                    <Separator/>

                    <TextBlock FontWeight="SemiBold" Margin="0,10,0,0" Text="Stats"/>
                    <TextBlock x:Name="TxtStats" Opacity="0.85" Margin="0,4,0,0" Text="-" TextWrapping="Wrap"/>

                    <Separator Margin="0,12,0,12"/>

                    <CheckBox x:Name="ChkWireframe" Content="Wireframe"
                              Checked="ChkWireframe_Changed"
                              Unchecked="ChkWireframe_Changed"/>

                    <CheckBox x:Name="ChkAutoFit" Content="Auto Fit View (on load)" IsChecked="True" Margin="0,6,0,0"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- Bottom log -->
        <TextBox x:Name="LogBox"
                 Grid.Row="2"
                 FontFamily="Consolas"
                 FontSize="13"
                 IsReadOnly="True"
                 TextWrapping="Wrap"
                 VerticalScrollBarVisibility="Auto"
                 HorizontalScrollBarVisibility="Auto"/>
    </Grid>
</Window>
